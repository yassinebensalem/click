@using DDD.Application.ViewModels;
@using DDD.Infra.CrossCutting.Identity.Models.AccountViewModels;
@using DDD.Domain.Models;

<div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 200px;">
    <!-- Position it -->
    <div style="position: absolute; top: 0; right: 0;">

        <!-- Then put toasts within -->
        <div class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-delay="500">
            <div class="toast-header">
                <img src="..." class="rounded mr-2" alt="...">
                <strong class="mr-auto">Bootstrap</strong>
                <small class="text-muted">just now</small>
                <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="toast-body">
                See? Just like this.
            </div>
        </div>
    </div>
</div>

<div class="border-bottom mb-6 pb-6 mb-lg-8 pb-lg-9" >
    <form id="CreateForm" class="pt-5 pl-md-5 pt-lg-8 pl-lg-9" asp-controller="Book" asp-action="AddBook">

        <h6 class="font-weight-medium font-size-7 ml-lg-1 mb-lg-8 pb-xl-1">Book Details </h6>
        <div class="font-weight-medium font-size-22 mb-4 pb-xl-1">Create Book </div>
        <div class="row">
            <div class="col-md-8 mb-4">
                <div class="js-form-message">
                    <label for="exampleFormControlInput1">Nom du Livre *</label>
                    <input type="text" class="form-control rounded-0 pl-3 placeholder-color-3" id="exampleFormControlInput1"
                           name="Title" aria-label="Jack Wayley" placeholder="Nom du livre" data-error-class="u-has-error"
                           data-msg="Please enter your name." data-success-class="u-has-success">
                </div>
            </div>

            <div class="col-md-8 mb-4">
                <div class="js-form-message">
                    <label for="exampleFormControlInput4">Description *</label>
                    <textarea name="Description" type="text"  placeholder="" rows="3" size="30"  class="form-control rounded-0 pl-3 placeholder-color-3"  
                            id="exampleFormControlInput4" >@Model.Description</textarea>
                </div>
            </div>

            <div class="row col-md-8 mb-4 mb-md-0">
                <div class="col-md-4 mb-4 ">
                    <div class="js-form-message">
                        <label for="exampleFormControlInput7">NbPages*</label>
                        <input type="number" class="form-control rounded-0" name="PageNumbers" id="exampleFormControlInput7" aria-label="Jack Wayley" data-error-class="u-has-error" data-msg="Please enter your name." data-success-class="u-has-success">
                    </div>

                </div>
                <div class="col-md-4 mb-4 ">
                    <div class="js-form-message">
                        <label for="exampleFormControlInput8">Prix *</label>
                        <input type="number" class="form-control rounded-0 " name="Price" id="exampleFormControlInput8" aria-label="Jack Wayley" data-error-class="u-has-error" data-msg="Please enter your name." data-success-class="u-has-success">

                    </div>
                </div>


            </div>



            <div class="row col-md-8 mb-4">
                <div class="col-md-6">
                    <div class="input-group-prepend mr-0 d-xl-block">
                        <div class="js-form-message">
                            <label for="exampleFormControlInput2">Catégorie *</label>

                            <select class="custom-select pr-7 pl-4 rounded-right-0 height-5 shadow-none  text-dark "
                                    id="inputGroupSelect2" name="CategoryId">
                       
                                @foreach (var item in (List<CategoryViewModel>)ViewBag.categories)
                                {
                                    <option value="@item.Id">@item.CategoryName</option>
                                }

                            </select>
                        </div>

                    </div>
                </div>
                <div class="col-md-6 ">
                    <div class="js-form-message">
                        <div class="input-group-prepend mr-0 d-xl-block">
                            <label for="exampleFormControlInput3">Auteur *</label>
                            <select class="custom-select pr-7 pl-4 rounded-right-0 height-5 shadow-none  text-dark" id="inputGroupSelect3" name="AuthorId">

                                @foreach (var item in (List<ApplicationUser>)ViewBag.appUser)
                                {
                                    <option value="@item.Id">@item.Email</option>

                                }
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class=" row col-md-8 mb-4 ">
                <div class="col-md-6 ">
                    <div class="js-form-message">
                        <div class="input-group-prepend mr-0  d-xl-block">
                            <label for="exampleFormControlInput6">Langue *</label>
                            <select class="custom-select pr-7 pl-4 rounded-right-0 height-5 shadow-none  text-dark" id="inputGroupSelect6" name="LanguageId" type="int">
                                <option value="1">France</option>
                                <option value="2">Tunisie</option>
                                <option value="3">Algérie</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 ">
                    <div class="js-form-message">
                        <div class="input-group-prepend mr-0  d-xl-block">
                            <label for="exampleFormControlInput6">Country *</label>
                            <select class="custom-select pr-7 pl-4 rounded-right-0 height-5 shadow-none  text-dark" id="inputGroupSelect6" name="CountryId" type="int">
                                @*<option selected>Country *</option>*@
                                <option value="1">EN</option>
                                <option value="2">FR</option>
                                <option value="3">AR</option>
                            </select>
                        </div>
                    </div>
                </div>

            </div>

            <div class="row col-md-8 mb-4 ">
                <div class="col-md-4 mb-4">
                    <div class="js-form-message">
                        <label for="exampleFormControlInput0">EISBN *</label>
                        <input type="text" class="form-control rounded-0" name="EISBN" id="exampleFormControlInput0" aria-label="Jack Wayley" data-error-class="u-has-error" data-msg="Please enter your name." data-success-class="u-has-success" type="int">
                    </div>

                </div>
                <div class="col-md-4 mb-4 ">
                    <div class="js-form-message">
                        <label for="exampleFormControlInput5">ISBN *</label>
                        <input type="text" class="form-control rounded-0  " name="ISBN" id="exampleFormControlInput5" aria-label="Jack Wayley" data-error-class="u-has-error" data-msg="Please enter your name." data-success-class="u-has-success">

                    </div>
                </div>
                <div class="col-md-4 mb-4 ">
                    <div class="js-form-message">
                        <label for="exampleFormControlInput2">ISSN *</label>
                        <input type="text" class="form-control rounded-0 " name="ISSN" id="exampleFormControlInput2" aria-label="Jack Wayley" data-error-class="u-has-error" data-msg="Please enter your name." data-success-class="u-has-success">

                    </div>
                </div>
            </div>




            <div class="row col-md-8  ">
                <div class="col-md-4 ">

                    <button type="submit" class="btn btn-block py-2 rounded-0 btn-dark-1">Save</button>

                </div>
            </div>

        </div>
    </form>


</div>

<script type="text/javascript">

    $(document).ready(function () {
        $('#CreateForm').submit(function (e) {
            e.preventDefault();
            var form = $(this);
            $.ajax({
                url: form.attr('action'),
                type: 'post',
                datatype: 'jsonp',
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({
                    "CategoryId": form.find("select[name='CategoryId']").val(),
                    "AuthorId": form.find("select[name='AuthorId']").val(),
                    "LanguageId": form.find("select[name='LanguageId']").val(),
                    "CountryId": form.find("select[name='CountryId']").val(),
                    "Title": form.find("input[name='Title']").val(),
                    "Description": form.find("input[name='Description']").val(),
                    "PageNumbers": form.find("input[name='PageNumbers']").val(),
                    "Price": form.find("input[name='Price']").val(),
                    "EISBN": form.find("input[name='EISBN']").val(),
                    "ISBN": form.find("input[name='ISBN']").val(),
                    "ISSN": form.find("input[name='ISSN']").val()
                }),
                success: function (data, textStatus, jQxhr) {
                    alert('success');
                    $("ul.my_account-nav li a.add-book").trigger('click');
                },
                error: function (jqXhr, textStatus, errorThrown) { console.log(errorThrown); }

            });
        });
    })
</script>
